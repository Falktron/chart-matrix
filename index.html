<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Matrix Chart</title>
  <!-- Chart.js v4 -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3"></script>
  <!-- chartjs-chart-matrix v3 -->
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@3.0.0"></script>
  <style>
    body { margin: 0; padding: 1rem; font-family: system-ui, sans-serif; }
    #wrap { max-width: 900px; margin: 0 auto; }
    canvas { width: 100%; height: 500px; }
  </style>
</head>
<body>
  <div id="wrap">
    <h1>Matrix</h1>
    <canvas id="matrix"></canvas>
  </div>

  <script>
    // 1) Beispiel-Daten (spÃ¤ter durch Fetch ersetzen)
    const raw = [
      {x:1, y:1, v:10}, {x:2, y:1, v:20}, {x:3, y:1, v:15},
      {x:1, y:2, v:5},  {x:2, y:2, v:30}, {x:3, y:2, v:12},
      {x:1, y:3, v:18}, {x:2, y:3, v:8},  {x:3, y:3, v:22}
    ];

    // 2) einfache Farbskala (0..30)
    function colorFor(v) {
      const t = Math.max(0, Math.min(1, v / 30));   // 0..1
      const c = Math.round(255 * t);                 // 0..255
      return `rgba(${c}, 50, ${255-c}, 0.85)`;
    }

    // 3) Chart-Konfig
    const cfg = {
      type: 'matrix',
      data: {
        datasets: [{
          label: 'Heatmap',
          data: raw,
          backgroundColor: ctx => colorFor(ctx.raw.v),
          borderWidth: 1,
          borderColor: 'rgba(0,0,0,0.2)',
          width:  ctx => (ctx.chart.chartArea.width  / 3) - 6,
          height: ctx => (ctx.chart.chartArea.height / 3) - 6,
        }]
      },
      options: {
        animation: false,
        plugins: { legend: { display: false }, tooltip: { callbacks: {
          title: (items) => `x=${items[0].raw.x}, y=${items[0].raw.y}`,
          label: (item) => `Wert: ${item.raw.v}`
        }}},
        scales: {
          x: { type: 'linear', min: 0.5, max: 3.5, ticks: { stepSize: 1 } },
          y: { type: 'linear', min: 0.5, max: 3.5, ticks: { stepSize: 1 }, reverse: true }
        }
      }
    };

    new Chart(document.getElementById('matrix'), cfg);
  </script>
</body>
</html>
